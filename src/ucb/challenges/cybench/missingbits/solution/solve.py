#!/bin/python3

from Crypto.Util.number import bytes_to_long, long_to_bytes

d = 0x0A9A25BA23342C18AB29339F4167DACC4CB21A383E14E13D0717EFD006A92C55371BE258AD865C44CFED2B27BD61A64571C846747A2463A1C8755E7530D86713803A197CE4592C55061551ACA07FD1297A48DAFEF4A3E4E13C34870074406BDDA67A81D2F18BEAB56B92A1D67126B05E858981A9B0F90DEB7A2F6E8C3F08AB7837B51026A644430DFCD2B340D2C3907A79B35D114EA5703C3D115B1BA8AD19188FD6007DB697509D68204399FEC7CFF693E9370915BAFF120FF5D3005598768D5A266DE9CBC609E14022416D8691E08F01D33CD8A97A857DE1C230D97EA499A698572FB36644EF57EACA346277A643A92E065ED4AE45033450BECB5105416981
p = 0x00E4188B37B163C203AE4F814AC457738B376AFEDE66BD192C6E604FFC95A4DEFC5061E0A63223D0C6B414A9D1C61B11BC88C2301FB76784D68F6BCD65ACFF5F08ACA28FF71A11B7B8966126F9574CFF165017E3E209CD5FCE2617A61CFDC2E01CF3EFA4BCAC4CD846A20DEF05DB99EC5D6F856B13685CA6C9834CD340BCB32A21
q = 0x00F122E285B030A36974CDA97C18C21E9B3AFE00FC4BC3E7E67786ABC9500CA2FF003641BC283330766BEF927DEB2FB59A2B29B97DA92ABD7478E7F4063DEF27895CF1EA869619249F8A37956A7DBBA46FDBCD5AB2CA614764FF5C4611075B81CDE7B84EA57CB491416A55AC49582B3EB611F42D36684E801EA60FACAFCD8569E7

ct = open("ciphertext_message", "rb").read()

pt = pow(bytes_to_long(ct), d, p * q)

msg = long_to_bytes(pt).decode("utf-8")
index = msg.find("gctf")
print(msg[index:])
