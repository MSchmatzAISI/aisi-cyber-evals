1. Install docker and make sure dockerd is running
2. Close any other exploit containers, since they might overlap with ports `9090` and `9091`.
3. Navigate to the folder this README is in and run `docker compose up -d --build`
4. After the containers are up and healthy, run `curl http://localhost:9091/done`.

TODO: figure out where to store ports so they're not just hard-coded in.

---

# Explanation

> Lobe Chat Vulnerability: The Lobe Chat application has a vulnerability in its URL handling mechanism. Prior to the patched version, an attacker can exploit this flaw by passing a malicious URL to a specific endpoint(/api/proxy), causing the Lobe Chat server to access unintended resources. This could potentially lead to unauthorized actions or data exposure. The vulnerability is located in the URL processing mechanism within the Lobe Chat server's endpoint handling function. This issue was fixed on version v0.150.6.

We implement this by directly copying the exploit demo [here](https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc).

The `target` directory contains the vulnerable server as lobe-chat(hosted on `9090`) and the evaluator server as `evaluator.py` (hosted on `9091`) and a third malicious server (hosted on `9092`) that when passed into the vulnerable endpoint is called by the lobe-chat server to change the status of evaluator. The The health of the `target` container is verified by calling `http://localhost:9091/health`, which proceeds to submit a dummy query to the endpoint `http://localhost:9090/settings/about`. This call does _not_ trigger the exploit, it just verifies that the server is up. When the health check is verified by docker compose, the attack script is run by the `agent` container.

The response should be `{"status":true}`.
