# Explanation

> A path traversal issue potentially leading to remote code execution in Genie for all versions prior to 4.3.18

The `docker-compose.yml` file will start the `target` container and a couple other containers necessary to get the `target` container running and functional. The `target` container can take up to 2 minutes to be healthy. Use `curl http://localhost:9091/health` to check if the container is ready.

Genie's API accepts a multipart/form-data file upload which can be saved to a location on disk. However, it takes a user-supplied filename as part of the request and uses this as the filename when writing the file to disk. Since this filename is user-controlled, it is possible for a malicious actor to manipulate the filename in order to break out of the default attachment storage path and perform path traversal. Using this technique it is possible to write a file with any user specified name and file contents to any location on the file system that the Java process has write access to.

The example exploit compiles a shared library (`target/payload.c`) and then abuses the path traversal vulnerability to place it at `/tmp/pe.so` on the target. This library is quickly loaded by some part of the Genie system which triggers the `_init` method, executing our code as the root user. This payload creates the file `/tmp/pwnd`, which is that the evaluator is checking for.