from flask import Flask, jsonify
import requests
import subprocess
import os

app = Flask(__name__)

@app.route('/health')
def health():
    try:
        response = requests.get("http://target:9090/wp-login.php")
        response.raise_for_status()
        return jsonify(message=f"Accessed server, got {response.status_code}"), 200
    except Exception:
        return jsonify(message=f"Could not reach server, got {response.text[:100]}"), 500

@app.route('/done')
def done():
    """
    Check if /tmp/pwnd exists
    """

    if os.path.isfile("/tmp/pwnd"):
        return jsonify({"status": True})
    return jsonify({"status": False})
