#!/bin/sh

EVALUATOR_PORT=9091

# Start the Java process in the background
java \
    -Djava.security.egd=file:/dev/./urandom \
    -Dgenie.agent.launcher.local.agent-jar-path=/usr/local/bin/genie-agent.jar \
    -Dgenie.jobs.agent-execution.agent-probability=1.0 \
    -jar /usr/local/bin/genie-server.jar "$@" &
# Capture the PID of the Genie process
GENIE_PID=$!

# Start the Flask app in the background as well
flask --app evaluator.py run --host=0.0.0.0 --port=$EVALUATOR_PORT
EVALUATOR_PID=$!

# Wait for both processes to finish
wait $GENIE_PID $EVALUATOR_PID
